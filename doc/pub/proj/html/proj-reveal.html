<!DOCTYPE html>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="How do develop a numerical project">

<title>How do develop a numerical project</title>







<!-- reveal.js: http://lab.hakim.se/reveal-js/ -->

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

<link rel="stylesheet" href="reveal.js/css/reveal.css">
<link rel="stylesheet" href="reveal.js/css/theme/beige.css" id="theme">
<!--
<link rel="stylesheet" href="reveal.js/css/reveal.css">
<link rel="stylesheet" href="reveal.js/css/theme/beige.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/beigesmall.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/solarized.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/serif.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/night.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/moon.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/simple.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/sky.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/darkgray.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/default.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/cbc.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/simula.css" id="theme">
-->

<!-- For syntax highlighting -->
<link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">

<!-- If the query includes 'print-pdf', use the PDF print sheet -->
<script>
document.write( '<link rel="stylesheet" href="reveal.js/css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
</script>

<style type="text/css">
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    p.caption { width: 80%; font-size: 60%; font-style: italic; text-align: left; }
    hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    .reveal .alert-text-small   { font-size: 80%;  }
    .reveal .alert-text-large   { font-size: 130%; }
    .reveal .alert-text-normal  { font-size: 90%;  }
    .reveal .alert {
             padding:8px 35px 8px 14px; margin-bottom:18px;
             text-shadow:0 1px 0 rgba(255,255,255,0.5);
             border:5px solid #bababa;
             -webkit-border-radius: 14px; -moz-border-radius: 14px;
             border-radius:14px
             background-position: 10px 10px;
             background-repeat: no-repeat;
             background-size: 38px;
             padding-left: 30px; /* 55px; if icon */
     }
     .reveal .alert-block {padding-top:14px; padding-bottom:14px}
     .reveal .alert-block > p, .alert-block > ul {margin-bottom:1em}
     /*.reveal .alert li {margin-top: 1em}*/
     .reveal .alert-block p+p {margin-top:5px}
     /*.reveal .alert-notice { background-image: url(http://hplgit.github.io/doconce/bundled/html_images/small_gray_notice.png); }
     .reveal .alert-summary  { background-image:url(http://hplgit.github.io/doconce/bundled/html_images/small_gray_summary.png); }
     .reveal .alert-warning { background-image: url(http://hplgit.github.io/doconce/bundled/html_images/small_gray_warning.png); }
     .reveal .alert-question {background-image:url(http://hplgit.github.io/doconce/bundled/html_images/small_gray_question.png); } */

</style>



<!-- Styles for table layout of slides -->
<style type="text/css">
td.padding {
  padding-top:20px;
  padding-bottom:20px;
  padding-right:50px;
  padding-left:50px;
}
</style>

</head>

<body>
<div class="reveal">

<!-- Any section element inside the <div class="slides"> container
     is displayed as a slide -->

<div class="slides">



    



<section>
<!-- ------------------- main content ---------------------- -->

<!-- Slides for PHY981 -->


<center><h1 style="text-align: center;">How do develop a numerical project</h1></center>  <!-- document title -->

<p>
<!-- author(s): Morten Hjorth-Jensen, National Superconducting Cyclotron Laboratory and Department of Physics and Astronomy, Michigan State University, East Lansing, MI 48824, USA &amp; Department of Physics, University of Oslo, Oslo, Norway -->

<center>
<b>Morten Hjorth-Jensen, National Superconducting Cyclotron Laboratory and Department of Physics and Astronomy, Michigan State University, East Lansing, MI 48824, USA &amp; Department of Physics, University of Oslo, Oslo, Norway</b> 
</center>

<p>&nbsp;<br>
<!-- institution(s) -->
<p>&nbsp;<br>
<center><h4>May 18-22 2015</h4></center> <!-- date -->
</section>


<section>
<h2 id="___sec0">Some basic ingredients for a successful numerical project </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
In when building up a numerical project there are several elements you should think of

<ol>

<p><li> How to structure a code in terms of functions</li>

<p><li> How to make a module</li>

<p><li> How to read input data flexibly from the command line</li>

<p><li> How to create graphical/web user interfaces</li>

<p><li> How to write unit tests (test functions or doctests)</li>

<p><li> How to refactor code in terms of classes (instead of functions only)</li>

<p><li> How to conduct and automate large-scale numerical experiments</li>

<p><li> How to write scientific reports in various formats (LaTeX, HTML)</li>
</ol>
</div>
</section>


<section>
<h2 id="___sec1">Additional benefits: A structure approach to solving problems </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The conventions and techniques outlined here will save you a lot of time when you incrementally extend software over time from simpler to more complicated problems. In particular, you will benefit from many good habits:

<ol>
<p><li> New code is added in a modular fashion to a library (modules)</li>
<p><li> Programs are run through convenient user interfaces</li>
<p><li> It takes one quick command to let all your code undergo heavy testing</li> 
<p><li> Tedious manual work with running programs is automated,</li>
<p><li> Your scientific investigations are reproducible, scientific reports with top quality typesetting are produced both for paper and electronic devices.</li>
</ol>
</div>
</section>


<section>
<h2 id="___sec2">Analysis of project, Configuration Interaction theory </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eeeedd"><pre style="font-size: 80%; line-height: 125%"><span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">numpy</span> <span style="color: #8B008B; font-weight: bold">import</span> *
<span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">sympy</span> <span style="color: #8B008B; font-weight: bold">import</span> *
<span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">matplotlib.pyplot</span> <span style="color: #8B008B; font-weight: bold">import</span> *


g_array = linspace(-<span style="color: #B452CD">1</span>, <span style="color: #B452CD">1</span>, <span style="color: #B452CD">1001</span>)
e1_array = []
e2_array = []

<span style="color: #8B008B; font-weight: bold">for</span> g <span style="color: #8B008B">in</span> g_array:
	H1 = matrix([[<span style="color: #B452CD">2</span>-g , -g/<span style="color: #B452CD">2.</span>,  -g/<span style="color: #B452CD">2.</span>, -g/<span style="color: #B452CD">2.</span>, -g/<span style="color: #B452CD">2.</span>,     <span style="color: #B452CD">0</span>], 
		        [-g/<span style="color: #B452CD">2.</span>,   <span style="color: #B452CD">4</span>-g,  -g/<span style="color: #B452CD">2.</span>, -g/<span style="color: #B452CD">2.</span>,    <span style="color: #B452CD">0.</span>, -g/<span style="color: #B452CD">2.</span>],
		        [-g/<span style="color: #B452CD">2.</span>, -g/<span style="color: #B452CD">2.</span>,    <span style="color: #B452CD">6</span>-g,     <span style="color: #B452CD">0</span>, -g/<span style="color: #B452CD">2.</span>, -g/<span style="color: #B452CD">2.</span>],
				[-g/<span style="color: #B452CD">2.</span>, -g/<span style="color: #B452CD">2.</span>,      <span style="color: #B452CD">0</span>,   <span style="color: #B452CD">6</span>-g, -g/<span style="color: #B452CD">2.</span>, -g/<span style="color: #B452CD">2.</span>],
				[-g/<span style="color: #B452CD">2.</span>,     <span style="color: #B452CD">0</span>,  -g/<span style="color: #B452CD">2.</span>, -g/<span style="color: #B452CD">2.</span>,   <span style="color: #B452CD">8</span>-g, -g/<span style="color: #B452CD">2.</span>],
				[<span style="color: #B452CD">0</span>    , -g/<span style="color: #B452CD">2.</span>,  -g/<span style="color: #B452CD">2.</span>, -g/<span style="color: #B452CD">2.</span>, -g/<span style="color: #B452CD">2.</span>,  <span style="color: #B452CD">10</span>-g]]) 

	H2 = matrix([[<span style="color: #B452CD">2</span>-g , -g/<span style="color: #B452CD">2.</span>,  -g/<span style="color: #B452CD">2.</span>, -g/<span style="color: #B452CD">2.</span>, -g/<span style="color: #B452CD">2.</span>], 
		        [-g/<span style="color: #B452CD">2.</span>,   <span style="color: #B452CD">4</span>-g,  -g/<span style="color: #B452CD">2.</span>, -g/<span style="color: #B452CD">2.</span>,    <span style="color: #B452CD">0.</span>],
		        [-g/<span style="color: #B452CD">2.</span>, -g/<span style="color: #B452CD">2.</span>,    <span style="color: #B452CD">6</span>-g,     <span style="color: #B452CD">0</span>, -g/<span style="color: #B452CD">2.</span>],
				[-g/<span style="color: #B452CD">2.</span>, -g/<span style="color: #B452CD">2.</span>,      <span style="color: #B452CD">0</span>,   <span style="color: #B452CD">6</span>-g, -g/<span style="color: #B452CD">2.</span>],
				[-g/<span style="color: #B452CD">2.</span>,     <span style="color: #B452CD">0</span>,  -g/<span style="color: #B452CD">2.</span>, -g/<span style="color: #B452CD">2.</span>,   <span style="color: #B452CD">8</span>-g]]) 

		

	u1, v1 = linalg.eig(H1)
	u2, v2 = linalg.eig(H2)

	<span style="color: #8B008B; font-weight: bold">if</span> g == <span style="color: #B452CD">1.</span>/<span style="color: #B452CD">2</span>:
		<span style="color: #8B008B; font-weight: bold">print</span> argmin(u1)

		<span style="color: #8B008B; font-weight: bold">for</span> i <span style="color: #8B008B">in</span> <span style="color: #658b00">range</span>(<span style="color: #B452CD">5</span>):
			<span style="color: #8B008B; font-weight: bold">print</span> <span style="color: #CD5555">&quot; %.3f &quot;</span> % v2[i,<span style="color: #B452CD">0</span>],



	e1_array.append(<span style="color: #658b00">min</span>(u1))
	e2_array.append(<span style="color: #658b00">min</span>(u2))


plot(g_array, e1_array, linewidth=<span style="color: #B452CD">2.0</span>)
<span style="color: #228B22">#plot(g_array, e2_array, linewidth=2.0)</span>
plot(g_array, (<span style="color: #B452CD">2</span>-g_array), linewidth=<span style="color: #B452CD">2.0</span>)
grid()
xlabel(<span style="color: #CD5555">r&quot;Strength of interaction, $g$&quot;</span>, fontsize=<span style="color: #B452CD">16</span>)
ylabel(<span style="color: #CD5555">r&#39;Ground state energy&#39;</span>, fontsize=<span style="color: #B452CD">16</span>)
<span style="color: #228B22">#axis([-1,1,-0.4,0.05])</span>
legend([<span style="color: #CD5555">&#39;FCI -- Exact&#39;</span>, <span style="color: #CD5555">&#39;Reference energy&#39;</span>])
savefig(<span style="color: #CD5555">&quot;proj1_ref2.pdf&quot;</span>)
show()
	
</pre></div>

</div>
</section>


<section>
<h2 id="___sec3">Analysis of project, Many-body perturbation theory </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eeeedd"><pre style="font-size: 80%; line-height: 125%"><span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">sympy</span> <span style="color: #8B008B; font-weight: bold">import</span> *
<span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">pylab</span> <span style="color: #8B008B; font-weight: bold">import</span> *

below_fermi = (<span style="color: #B452CD">0</span>,<span style="color: #B452CD">1</span>,<span style="color: #B452CD">2</span>,<span style="color: #B452CD">3</span>)
above_fermi = (<span style="color: #B452CD">4</span>,<span style="color: #B452CD">5</span>,<span style="color: #B452CD">6</span>,<span style="color: #B452CD">7</span>)

states = [(<span style="color: #B452CD">1</span>,<span style="color: #B452CD">1</span>),(<span style="color: #B452CD">1</span>,-<span style="color: #B452CD">1</span>),(<span style="color: #B452CD">2</span>,<span style="color: #B452CD">1</span>),(<span style="color: #B452CD">2</span>,-<span style="color: #B452CD">1</span>),(<span style="color: #B452CD">3</span>,<span style="color: #B452CD">1</span>),(<span style="color: #B452CD">3</span>,-<span style="color: #B452CD">1</span>),(<span style="color: #B452CD">4</span>,<span style="color: #B452CD">1</span>),(<span style="color: #B452CD">4</span>,-<span style="color: #B452CD">1</span>)]
N = <span style="color: #B452CD">8</span>
g = Symbol(<span style="color: #CD5555">&#39;g&#39;</span>)



<span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">h0</span>(p,q):
	<span style="color: #8B008B; font-weight: bold">if</span> p == q:
		p1, s1 = states[p]
		<span style="color: #8B008B; font-weight: bold">return</span> (p1 - <span style="color: #B452CD">1</span>)	
	<span style="color: #8B008B; font-weight: bold">else</span>:
		<span style="color: #8B008B; font-weight: bold">return</span> <span style="color: #B452CD">0</span>

<span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">f</span>(p,q):
	<span style="color: #8B008B; font-weight: bold">if</span> p == q:
		<span style="color: #8B008B; font-weight: bold">return</span> <span style="color: #B452CD">0</span>

	s = h0(p,q)
	<span style="color: #8B008B; font-weight: bold">for</span> i <span style="color: #8B008B">in</span> below_fermi:
		s += assym(p,i,q,i)
	<span style="color: #8B008B; font-weight: bold">return</span> s


<span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">assym</span>(p,q,r,s):
	p1, s1 = states[p]
	p2, s2 = states[q]
	p3, s3 = states[r]
	p4, s4 = states[s]

	<span style="color: #8B008B; font-weight: bold">if</span> p1 != p2 <span style="color: #8B008B">or</span> p3 != p4:
		<span style="color: #8B008B; font-weight: bold">return</span> <span style="color: #B452CD">0</span>
	<span style="color: #8B008B; font-weight: bold">if</span> s1 == s2 <span style="color: #8B008B">or</span> s3 == s4:
		<span style="color: #8B008B; font-weight: bold">return</span> <span style="color: #B452CD">0</span>
	<span style="color: #8B008B; font-weight: bold">if</span> s1 == s3 <span style="color: #8B008B">and</span> s2 == s4:
		<span style="color: #8B008B; font-weight: bold">return</span> -g/<span style="color: #B452CD">2.</span>
	<span style="color: #8B008B; font-weight: bold">if</span> s1 == s4 <span style="color: #8B008B">and</span> s2 == s3:
		<span style="color: #8B008B; font-weight: bold">return</span> g/<span style="color: #B452CD">2.</span>

<span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">eps</span>(holes, particles):
	E = <span style="color: #B452CD">0</span>
	<span style="color: #8B008B; font-weight: bold">for</span> h <span style="color: #8B008B">in</span> holes:
		p, s = states[h]
		E += (p-<span style="color: #B452CD">1</span>)
	<span style="color: #8B008B; font-weight: bold">for</span> p <span style="color: #8B008B">in</span> particles:
		p, s = states[p]
		E -= (p-<span style="color: #B452CD">1</span>)
	<span style="color: #8B008B; font-weight: bold">return</span> E


<span style="color: #228B22"># Diagram 3</span>
<span style="color: #228B22"># s = 0 </span>
<span style="color: #228B22"># for a in above_fermi:</span>
<span style="color: #228B22"># 	for b in above_fermi:</span>
<span style="color: #228B22"># 		for c in above_fermi:</span>
<span style="color: #228B22"># 			for i in below_fermi:</span>
<span style="color: #228B22"># 				for j in below_fermi:</span>
<span style="color: #228B22"># 					for k in below_fermi:</span>
<span style="color: #228B22"># 						s += assym(i,j,a,b)*assym(a,c,j,k)*assym(b,k,c,i)/eps((i,j),(a,b))/eps((k,j),(a,c))</span>
<span style="color: #228B22"># print s</span>


<span style="color: #228B22"># ga = linspace(-1,1,101)</span>
<span style="color: #228B22"># corr2 = []</span>
<span style="color: #228B22"># corr3 = []</span>
<span style="color: #228B22"># corrx = []</span>


<span style="color: #228B22"># Diagram 1</span>
s1 = <span style="color: #B452CD">0</span>
<span style="color: #8B008B; font-weight: bold">for</span> a <span style="color: #8B008B">in</span> above_fermi:
	<span style="color: #8B008B; font-weight: bold">for</span> b <span style="color: #8B008B">in</span> above_fermi:
		<span style="color: #8B008B; font-weight: bold">for</span> i <span style="color: #8B008B">in</span> below_fermi:
			<span style="color: #8B008B; font-weight: bold">for</span> j <span style="color: #8B008B">in</span> below_fermi:
				s1 += <span style="color: #B452CD">0.25</span>*assym(a,b,i,j)*assym(i,j,a,b)/eps((i,j),(a,b))

<span style="color: #228B22"># Diagram 4</span>
s4 = <span style="color: #B452CD">0</span>
<span style="color: #8B008B; font-weight: bold">for</span> a <span style="color: #8B008B">in</span> above_fermi:
	<span style="color: #8B008B; font-weight: bold">for</span> b <span style="color: #8B008B">in</span> above_fermi:
		<span style="color: #8B008B; font-weight: bold">for</span> c <span style="color: #8B008B">in</span> above_fermi:
			<span style="color: #8B008B; font-weight: bold">for</span> d <span style="color: #8B008B">in</span> above_fermi:
				<span style="color: #8B008B; font-weight: bold">for</span> i <span style="color: #8B008B">in</span> below_fermi:
					<span style="color: #8B008B; font-weight: bold">for</span> j <span style="color: #8B008B">in</span> below_fermi:
						s4 += <span style="color: #B452CD">0.125</span>*assym(i,j,a,b)*assym(a,b,c,d)*assym(c,d,i,j)/eps((i,j),(a,b))/eps((i,j),(c,d))

<span style="color: #228B22"># Diagram 5</span>
s5 = <span style="color: #B452CD">0</span>
<span style="color: #8B008B; font-weight: bold">for</span> a <span style="color: #8B008B">in</span> above_fermi:
	<span style="color: #8B008B; font-weight: bold">for</span> b <span style="color: #8B008B">in</span> above_fermi:
		<span style="color: #8B008B; font-weight: bold">for</span> i <span style="color: #8B008B">in</span> below_fermi:
			<span style="color: #8B008B; font-weight: bold">for</span> j <span style="color: #8B008B">in</span> below_fermi:
				<span style="color: #8B008B; font-weight: bold">for</span> k <span style="color: #8B008B">in</span> below_fermi:
					<span style="color: #8B008B; font-weight: bold">for</span> l <span style="color: #8B008B">in</span> below_fermi:
						s5 += <span style="color: #B452CD">0.125</span>*assym(i,j,a,b)*assym(k,l,i,j)*assym(a,b,k,l)/eps((i,j),(a,b))/eps((k,l),(a,b))

<span style="color: #228B22"># Diagram 8 (simplified)</span>
s8 = <span style="color: #B452CD">0</span> 
<span style="color: #8B008B; font-weight: bold">for</span> a <span style="color: #8B008B">in</span> above_fermi:
	<span style="color: #8B008B; font-weight: bold">for</span> b <span style="color: #8B008B">in</span> above_fermi:
		<span style="color: #8B008B; font-weight: bold">for</span> i <span style="color: #8B008B">in</span> below_fermi:
			<span style="color: #8B008B; font-weight: bold">for</span> j <span style="color: #8B008B">in</span> below_fermi:
				<span style="color: #8B008B; font-weight: bold">for</span> k <span style="color: #8B008B">in</span> below_fermi:
					s8 -= <span style="color: #B452CD">0.5</span>*assym(i,j,a,b)*assym(a,b,i,k)*f(k,j)/eps((i,j),(a,b))/eps((i,k),(a,b))

<span style="color: #228B22"># Diagram 9 (simplified)</span>
s9 = <span style="color: #B452CD">0</span> 
<span style="color: #8B008B; font-weight: bold">for</span> a <span style="color: #8B008B">in</span> above_fermi:
	<span style="color: #8B008B; font-weight: bold">for</span> b <span style="color: #8B008B">in</span> above_fermi:
		<span style="color: #8B008B; font-weight: bold">for</span> c <span style="color: #8B008B">in</span> above_fermi:
			<span style="color: #8B008B; font-weight: bold">for</span> i <span style="color: #8B008B">in</span> below_fermi:
				<span style="color: #8B008B; font-weight: bold">for</span> j <span style="color: #8B008B">in</span> below_fermi:
					s9 += <span style="color: #B452CD">0.5</span>*assym(i,j,a,b)*assym(a,c,i,j)*f(b,c)/eps((i,j),(a,b))/eps((i,j),(a,c))


<span style="color: #8B008B; font-weight: bold">print</span> s1
<span style="color: #8B008B; font-weight: bold">print</span> s4
<span style="color: #8B008B; font-weight: bold">print</span> s5
<span style="color: #8B008B; font-weight: bold">print</span> s8
<span style="color: #8B008B; font-weight: bold">print</span> s9

s_5 =  -<span style="color: #B452CD">0.0291521990740741</span>*g**<span style="color: #B452CD">4</span>
s14 =  -<span style="color: #B452CD">0.0308883101851853</span>*g**<span style="color: #B452CD">4</span>
s34 =  <span style="color: #B452CD">0.0163049768518519</span>*g**<span style="color: #B452CD">4</span>
s36 =  -<span style="color: #B452CD">0.0145760995370371</span>*g**<span style="color: #B452CD">4</span>
s38 =  -<span style="color: #B452CD">0.0201099537037037</span>*g**<span style="color: #B452CD">4</span>
s39 =  <span style="color: #B452CD">0.0176938657407407</span>*g**<span style="color: #B452CD">4</span>

ga = linspace(-<span style="color: #B452CD">1</span>,<span style="color: #B452CD">1</span>,<span style="color: #B452CD">10001</span>)
e1 = []
corr2 = []
corr3 = []
corr4 = []
<span style="color: #8B008B; font-weight: bold">for</span> g_val <span style="color: #8B008B">in</span> ga:
	H1 = matrix([[<span style="color: #B452CD">2</span>-g_val , -g_val/<span style="color: #B452CD">2.</span>,  -g_val/<span style="color: #B452CD">2.</span>, -g_val/<span style="color: #B452CD">2.</span>, -g_val/<span style="color: #B452CD">2.</span>,     <span style="color: #B452CD">0</span>], 
		        [-g_val/<span style="color: #B452CD">2.</span>,   <span style="color: #B452CD">4</span>-g_val,  -g_val/<span style="color: #B452CD">2.</span>, -g_val/<span style="color: #B452CD">2.</span>,    <span style="color: #B452CD">0.</span>, -g_val/<span style="color: #B452CD">2.</span>],
		        [-g_val/<span style="color: #B452CD">2.</span>, -g_val/<span style="color: #B452CD">2.</span>,    <span style="color: #B452CD">6</span>-g_val,     <span style="color: #B452CD">0</span>, -g_val/<span style="color: #B452CD">2.</span>, -g_val/<span style="color: #B452CD">2.</span>],
				[-g_val/<span style="color: #B452CD">2.</span>, -g_val/<span style="color: #B452CD">2.</span>,      <span style="color: #B452CD">0</span>,   <span style="color: #B452CD">6</span>-g_val, -g_val/<span style="color: #B452CD">2.</span>, -g_val/<span style="color: #B452CD">2.</span>],
				[-g_val/<span style="color: #B452CD">2.</span>,     <span style="color: #B452CD">0</span>,  -g_val/<span style="color: #B452CD">2.</span>, -g_val/<span style="color: #B452CD">2.</span>,   <span style="color: #B452CD">8</span>-g_val, -g_val/<span style="color: #B452CD">2.</span>],
				[<span style="color: #B452CD">0</span>    , -g_val/<span style="color: #B452CD">2.</span>,  -g_val/<span style="color: #B452CD">2.</span>, -g_val/<span style="color: #B452CD">2.</span>, -g_val/<span style="color: #B452CD">2.</span>,  <span style="color: #B452CD">10</span>-g_val]]) 

	u1, v1 = linalg.eig(H1)
	e1.append(<span style="color: #658b00">min</span>(u1))

	corr2.append((s1).subs(g,g_val))
	corr3.append((s1+s4+s5).subs(g,g_val))
	corr4.append((s1+s4+s5+<span style="color: #B452CD">2</span>*s_5+<span style="color: #B452CD">2</span>*s14+<span style="color: #B452CD">2</span>*s34+<span style="color: #B452CD">2</span>*s36+s38+<span style="color: #B452CD">2</span>*s39).subs(g,g_val))

exact = e1 - (<span style="color: #B452CD">2</span>-ga)

plot(ga, exact, linewidth=<span style="color: #B452CD">2.0</span>)
plot(ga, corr2, linewidth=<span style="color: #B452CD">2.0</span>)
plot(ga, corr3, linewidth=<span style="color: #B452CD">2.0</span>)
plot(ga, corr4, linewidth=<span style="color: #B452CD">2.0</span>)
xlabel(<span style="color: #CD5555">r&#39;Interaction strength, $g$&#39;</span>, fontsize=<span style="color: #B452CD">16</span>)
ylabel(<span style="color: #CD5555">r&#39;Correlation energy&#39;</span>, fontsize=<span style="color: #B452CD">16</span>)
axis([-<span style="color: #B452CD">1</span>,<span style="color: #B452CD">1</span>,-<span style="color: #B452CD">0.5</span>,<span style="color: #B452CD">0.05</span>])
grid()
legend([<span style="color: #CD5555">&quot;Exact&quot;</span>, <span style="color: #CD5555">&quot;2. order MPBT&quot;</span>, <span style="color: #CD5555">&quot;3. order MPBT&quot;</span>, <span style="color: #CD5555">&quot;4. order MPBT&quot;</span>], <span style="color: #CD5555">&#39;lower left&#39;</span>)
savefig(<span style="color: #CD5555">&quot;pert_2.pdf&quot;</span>)
show()


error1 = zeros(<span style="color: #658b00">len</span>(exact))
error2 = zeros(<span style="color: #658b00">len</span>(exact))
error3 = zeros(<span style="color: #658b00">len</span>(exact))

<span style="color: #8B008B; font-weight: bold">for</span> i <span style="color: #8B008B">in</span> <span style="color: #658b00">range</span>(<span style="color: #658b00">len</span>(exact)):
	error1[i] = <span style="color: #658b00">abs</span>(<span style="color: #658b00">float</span>(exact[i]-corr2[i]))
	error2[i] = <span style="color: #658b00">abs</span>(<span style="color: #658b00">float</span>(exact[i]-corr3[i]))
	error3[i] = <span style="color: #658b00">abs</span>(<span style="color: #658b00">float</span>(exact[i]-corr4[i]))

error1 = array(error1)
error2 = array(error2)
error3 = array(error3)
<span style="color: #8B008B; font-weight: bold">print</span> <span style="color: #658b00">type</span>(error1)

plot(ga, log10(error1))
plot(ga, log10(error2))
plot(ga, log10(error3))
xlabel(<span style="color: #CD5555">r&quot;Strength of interaction, $g$&quot;</span>, fontsize=<span style="color: #B452CD">16</span>)
ylabel(<span style="color: #CD5555">r&quot;Error, $\log_{\rm 10}({\rm abs}({\rm error})$&quot;</span>, fontsize=<span style="color: #B452CD">16</span>)
legend([<span style="color: #CD5555">&quot;2. order MPBT&quot;</span>, <span style="color: #CD5555">&quot;3. order MPBT&quot;</span>, <span style="color: #CD5555">&quot;4. order MPBT&quot;</span>], <span style="color: #CD5555">&#39;lower left&#39;</span>)
grid()
savefig(<span style="color: #CD5555">&quot;logerror.pdf&quot;</span>)
show()
</pre></div>

</div>
</section>



</div> <!-- class="slides" -->
</div> <!-- class="reveal" -->

<script src="reveal.js/lib/js/head.min.js"></script>
<script src="reveal.js/js/reveal.min.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

    // Display navigation controls in the bottom right corner
    controls: true,

    // Display progress bar (below the horiz. slider)
    progress: true,

    // Display the page number of the current slide
    slideNumber: true,

    // Push each slide change to the browser history
    history: false,

    // Enable keyboard shortcuts for navigation
    keyboard: true,

    // Enable the slide overview mode
    overview: true,

    // Vertical centering of slides
    //center: true,
    center: false,

    // Enables touch navigation on devices with touch input
    touch: true,

    // Loop the presentation
    loop: false,

    // Change the presentation direction to be RTL
    rtl: false,

    // Turns fragments on and off globally
    fragments: true,

    // Flags if the presentation is running in an embedded mode,
    // i.e. contained within a limited portion of the screen
    embedded: false,

    // Number of milliseconds between automatically proceeding to the
    // next slide, disabled when set to 0, this value can be overwritten
    // by using a data-autoslide attribute on your slides
    autoSlide: 0,

    // Stop auto-sliding after user input
    autoSlideStoppable: true,

    // Enable slide navigation via mouse wheel
    mouseWheel: false,

    // Hides the address bar on mobile devices
    hideAddressBar: true,

    // Opens links in an iframe preview overlay
    previewLinks: false,

    // Transition style
    transition: 'default', // default/cube/page/concave/zoom/linear/fade/none

    // Transition speed
    transitionSpeed: 'default', // default/fast/slow

    // Transition style for full page slide backgrounds
    backgroundTransition: 'default', // default/none/slide/concave/convex/zoom

    // Number of slides away from the current that are visible
    viewDistance: 3,

    // Parallax background image
    //parallaxBackgroundImage: '', // e.g. "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'"

    // Parallax background size
    //parallaxBackgroundSize: '' // CSS syntax, e.g. "2100px 900px"

    theme: Reveal.getQueryHash().theme, // available themes are in reveal.js/css/theme
    transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/none

});

Reveal.initialize({
    dependencies: [
        // Cross-browser shim that fully implements classList - https://github.com/eligrey/classList.js/
        { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },

        // Interpret Markdown in <section> elements
        { src: 'reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
        { src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },

        // Syntax highlight for <code> elements
        { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },

        // Zoom in and out with Alt+click
        { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },

        // Speaker notes
        { src: 'reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },

        // Remote control your reveal.js presentation using a touch device
        //{ src: 'reveal.js/plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } },

        // MathJax
        //{ src: 'reveal.js/plugin/math/math.js', async: true }
    ]
});

Reveal.initialize({

    // The "normal" size of the presentation, aspect ratio will be preserved
    // when the presentation is scaled to fit different resolutions. Can be
    // specified using percentage units.
    width: 1170,  // original: 960,
    height: 700,

    // Factor of the display size that should remain empty around the content
    margin: 0.1,

    // Bounds for smallest/largest possible scale to apply to content
    minScale: 0.2,
    maxScale: 1.0

});
</script>

<!-- begin footer logo
<div style="position: absolute; bottom: 0px; left: 0; margin-left: 0px">
<img src="somelogo.png">
</div>
     end footer logo -->



</body>
</html>
